jQuery(document).ready(function(s){function e(e){let r=!0;return e.find(".lukio_user_forms_input_wrapper.luf_required").removeClass("error").each(function(){let e=s(this);e.find("input, textarea").each(function(){let o=s(this),t=o.attr("type"),i=!1;i="INPUT"!=o.prop("tagName")||"checkbox"!=t&&"radio"!=t?""!=o.val().trim():0!=e.find("input:checked").length,i||(e.addClass("error"),r=!1)})}),r}function r(s){let e=s.closest(".lukio_user_forms_password_inpout_wrapper").siblings(".lukio_user_forms_password_strength"),r=s.val();if(e.removeClass("short bad good strong empty"),r&&""!==r.trim()){switch(strength=wp.passwordStrength.meter(r,wp.passwordStrength.userInputDisallowedList(),r),strength){case-1:e.addClass("bad").html(pwsL10n.unknown);break;case 2:e.addClass("bad").html(pwsL10n.bad);break;case 3:e.addClass("good").html(pwsL10n.good);break;case 4:e.addClass("strong").html(pwsL10n.strong);break;case 5:e.addClass("short").html(pwsL10n.mismatch);break;default:e.addClass("short").html(pwsL10n.short)}return strength}e.addClass("empty").html("")}function o(s){let e=s.find('input[name="pass1"]'),r=s.find('input[name="pass2"]'),o=r.closest(".lukio_user_forms_input_wrapper");return o.removeClass("error"),e.val()===r.val()||(o.addClass("error"),!1)}function t(s,r=null){let o=s.find(".lukio_user_forms_submit");if(o.hasClass(u))return;let t=e(s),n=!0;if(null!==r&&0==r(s)&&(n=!1),!t||!n)return;o.addClass(u);let a=s.siblings(".lukio_user_forms_result_error");a.removeClass("show").html(""),i(s,o,a)}function i(e,r,o){s.ajax({method:"POST",url:lukio_user_forms_data.ajax_url,data:e.serialize(),success:function(t){if(t)if(t=JSON.parse(t),"success"==t.status){let o=t.redirect;if(e.hasClass("login")){let e=s("body").triggerHandler("lukio_user_forms_login_redirect_overwrite");e&&(o=!0===e?"reload":e)}switch(o){case void 0:r.removeClass(u);break;case"no_redirect":e.trigger("form_success",[t]);break;case"reload":window.location.reload();break;default:window.location.href=t.redirect}}else t.error&&o.html(t.error).addClass("show"),r.removeClass(u),e.trigger("form_error",[t])}})}function n(e){return console.log(e.find('input[name="pass2"]').length),0==e.find('input[name="pass2"]').length?$password_check=!0:$password_check=o(e),$pluggable_check=!1!==s("body").triggerHandler("lukio_user_forms_register_check",[e]),$password_check&&$pluggable_check}async function a(){let e=new URLSearchParams(location.search),r=lukio_user_forms_data.password_reset;if(!e.has(r))return;let o=s(".lukio_user_forms_popup_wrapper.password_reset");if(0==o.length){let t={action:"lukio_user_forms_get_reset",login:e.get("login")};t[r]=e.get(r),await s.ajax({method:"GET",url:lukio_user_forms_data.ajax_url,data:t,success:function(e){if(e&&(e=JSON.parse(e),e.fragment)){let r=s("body");r.append(e.fragment),r.append(`<script src="${_zxcvbnSettings.src}" type="text/javascript"></script>`),o=s(".lukio_user_forms_popup_wrapper.password_reset")}}})}o.show()}function _(e){let r=lukio_user_forms_data.integration_redirect,o=s("body").triggerHandler("lukio_user_forms_login_redirect_overwrite");o&&(r=!0===o?"reload":o),s.ajax({method:"POST",url:lukio_user_forms_data.ajax_url,data:Object.assign({action:"lukio_user_forms_integrations_request",redirect_to:r},e),success:function(s){s&&(s=JSON.parse(s),s.success&&"reload"!=s.redirect?location.href=s.redirect:location.reload())}})}function l(s){_({integration:"google",token:s.credential})}let u="working";s(".no_js").removeClass("no_js"),a(),window.handle_google_credential_response=l,s(document).on("click",".lukio_user_forms_password_toggle",function(){let e=s(this),r=e.siblings(".lukio_user_forms_input.password"),o="password"==r.attr("type");r.attr("type",o?"text":"password"),e.attr("aria-label",o?lukio_user_forms_data.hide_password:lukio_user_forms_data.show_password),e.find(".lukio_user_forms_password_toggle_icon").removeClass(o?"dashicons-visibility":"dashicons-hidden").addClass(o?"dashicons-hidden":"dashicons-visibility")}).on("submit",".lukio_user_forms_form.login",function(e){e.preventDefault(),t(s(this))}).on("input",".lukio_user_forms_input",function(){s(this).closest(".lukio_user_forms_input_wrapper").removeClass("error")}).on("change",".lukio_user_forms_meta_checkbox",function(){s(this).closest(".lukio_user_forms_input_wrapper").removeClass("error")}).on("input",".lukio_user_forms_input.strength_check",function(){let e=s(this),o=e.closest("form").find(".lukio_user_forms_submit"),t=r(e);t<lukio_user_forms_data.password_strength?o.attr("disabled","disabled"):o.removeAttr("disabled")}).on("submit",".lukio_user_forms_form.reset_password",function(e){e.preventDefault(),t(s(this),o)}).on("click",".lukio_user_forms_popup_content",function(s){s.stopPropagation()}).on("click",".lukio_user_forms_popup_wrapper",function(){s(this).hide()}).on("click",".lukio_user_forms_popup_close",function(){s(this).closest(".lukio_user_forms_popup_wrapper").trigger("click")}).on("click",".lukio_user_forms_login_lost_switch",function(e){e.preventDefault(),s(this).closest(".lukio_user_forms_login_wrapper").find(".lukio_user_forms_login_content, .lukio_user_forms_lost_content").toggleClass("hide_content")}).on("submit",".lukio_user_forms_form.lost_password",function(e){e.preventDefault(),t(s(this))}).on("form_success",".lukio_user_forms_form",function(){s(this).addClass("success")}).on("submit",".lukio_user_forms_form.register",function(e){e.preventDefault(),t(s(this),n)}).on("form_error",".lukio_user_forms_form.register",function(e,r){if(r.fields){let e=s(this);r.fields.forEach(s=>{e.find(`input[name="${s}"]`).closest(".lukio_user_forms_input_wrapper").addClass("error")})}}).on("click",".lukio_user_forms_combo_switch",function(e){e.preventDefault(),s(this).closest(".lukio_user_forms_combo_wrapper").find(".lukio_user_forms_combo_form_wrapper").toggleClass("hide_content")}).on("click",".lukio_user_forms_integrations_button.facebook",function(){FB.login(function(s){s.authResponse&&_({integration:"facebook",access_token:s.authResponse.accessToken})},{scope:"public_profile,email"})})});