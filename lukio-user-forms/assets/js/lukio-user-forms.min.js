jQuery(document).ready(function(s){function r(r){let e=!0;return r.find(".lukio_user_forms_input_wrapper.luf_required").removeClass("error").each(function(){let r=s(this);r.find("input, textarea").each(function(){let o=s(this),t=o.attr("type"),i=!1;i="INPUT"!=o.prop("tagName")||"checkbox"!=t&&"radio"!=t?""!=o.val().trim():0!=r.find("input:checked").length,i||(r.addClass("error"),e=!1)})}),e}function e(s){let r=s.closest(".lukio_user_forms_password_inpout_wrapper").siblings(".lukio_user_forms_password_strength"),e=s.val();if(r.removeClass("short bad good strong empty"),e&&""!==e.trim()){switch(strength=wp.passwordStrength.meter(e,wp.passwordStrength.userInputDisallowedList(),e),strength){case-1:r.addClass("bad").html(pwsL10n.unknown);break;case 2:r.addClass("bad").html(pwsL10n.bad);break;case 3:r.addClass("good").html(pwsL10n.good);break;case 4:r.addClass("strong").html(pwsL10n.strong);break;case 5:r.addClass("short").html(pwsL10n.mismatch);break;default:r.addClass("short").html(pwsL10n.short)}return strength}r.addClass("empty").html("")}function o(s){let r=s.find('input[name="pass1"]'),e=s.find('input[name="pass2"]'),o=e.closest(".lukio_user_forms_input_wrapper");return o.removeClass("error"),r.val()===e.val()||(o.addClass("error"),!1)}function t(s,e=null){let o=s.find(".lukio_user_forms_submit");if(o.hasClass(_))return;let t=r(s),a=!0;if(null!==e&&0==e(s)&&(a=!1),!t||!a)return;o.addClass(_);let n=s.siblings(".lukio_user_forms_result_error");n.removeClass("show").html(""),i(s,o,n)}function i(r,e,o){s.ajax({method:"POST",url:lukio_user_forms_data.ajax_url,data:r.serialize(),success:function(s){if(s)if(s=JSON.parse(s),"success"==s.status)switch(s.redirect){case void 0:e.removeClass(_);break;case"no_redirect":r.trigger("form_success",[s]);break;case"reload":window.location.reload();break;default:window.location.href=s.redirect}else s.error&&o.html(s.error).addClass("show"),e.removeClass(_),r.trigger("form_error",[s])}})}function a(r){return console.log(r.find('input[name="pass2"]').length),0==r.find('input[name="pass2"]').length?$password_check=!0:$password_check=o(r),$pluggable_check=!1!==s("body").triggerHandler("lukio_user_forms_register_check",[r]),$password_check&&$pluggable_check}async function n(){let r=new URLSearchParams(location.search),e=lukio_user_forms_data.password_reset;if(!r.has(e))return;let o=s(".lukio_user_forms_popup_wrapper.password_reset");if(0==o.length){let t={action:"lukio_user_forms_get_reset",login:r.get("login")};t[e]=r.get(e),await s.ajax({method:"GET",url:lukio_user_forms_data.ajax_url,data:t,success:function(r){if(r&&(r=JSON.parse(r),r.fragment)){let e=s("body");e.append(r.fragment),e.append(`<script src="${_zxcvbnSettings.src}" type="text/javascript"></script>`),o=s(".lukio_user_forms_popup_wrapper.password_reset")}}})}o.show()}let _="working";s(".no_js").removeClass("no_js"),n(),s(document).on("click",".lukio_user_forms_password_toggle",function(){let r=s(this),e=r.siblings(".lukio_user_forms_input.password"),o="password"==e.attr("type");e.attr("type",o?"text":"password"),r.attr("aria-label",o?lukio_user_forms_data.show_password:lukio_user_forms_data.hide_password),r.find(".lukio_user_forms_password_toggle_icon").removeClass(o?"dashicons-visibility":"dashicons-hidden").addClass(o?"dashicons-hidden":"dashicons-visibility")}).on("submit",".lukio_user_forms_form.login",function(r){r.preventDefault(),t(s(this))}).on("input",".lukio_user_forms_input",function(){s(this).closest(".lukio_user_forms_input_wrapper").removeClass("error")}).on("change",".lukio_user_forms_meta_checkbox",function(){s(this).closest(".lukio_user_forms_input_wrapper").removeClass("error")}).on("input",".lukio_user_forms_input.strength_check",function(){let r=s(this),o=r.closest("form").find(".lukio_user_forms_submit"),t=e(r);t<lukio_user_forms_data.password_strength?o.attr("disabled","disabled"):o.removeAttr("disabled")}).on("submit",".lukio_user_forms_form.reset_password",function(r){r.preventDefault(),t(s(this),o)}).on("click",".lukio_user_forms_popup_content",function(s){s.stopPropagation()}).on("click",".lukio_user_forms_popup_wrapper",function(){s(this).hide()}).on("click",".lukio_user_forms_popup_close",function(){s(this).closest(".lukio_user_forms_popup_wrapper").trigger("click")}).on("click",".lukio_user_forms_login_lost_switch",function(r){r.preventDefault(),s(this).closest(".lukio_user_forms_login_wrapper").find(".lukio_user_forms_login_content, .lukio_user_forms_lost_content").toggleClass("hide_content")}).on("submit",".lukio_user_forms_form.lost_password",function(r){r.preventDefault(),t(s(this))}).on("form_success",".lukio_user_forms_form",function(){s(this).addClass("success")}).on("submit",".lukio_user_forms_form.register",function(r){r.preventDefault(),t(s(this),a)}).on("form_error",".lukio_user_forms_form.register",function(r,e){if(e.fields){let r=s(this);e.fields.forEach(s=>{r.find(`input[name="${s}"]`).closest(".lukio_user_forms_input_wrapper").addClass("error")})}}).on("click",".lukio_user_forms_combo_switch",function(r){r.preventDefault(),s(this).closest(".lukio_user_forms_combo_wrapper").find(".lukio_user_forms_combo_form_wrapper").toggleClass("hide_content")})});